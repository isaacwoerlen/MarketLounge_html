<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>README_media.md</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>README_media.md</h1>
    <pre><code>---

# ğŸ“˜ README â€” App `media`

> Ce fichier respecte les conventions dÃ©crites dans [`README Brief Technique.md`](../README Brief Technique.md), situÃ© Ã  la racine du dossier `apps/`.  
> Il dÃ©crit lâ€™objectif, le type, les composants, lâ€™intÃ©gration, et les responsabilitÃ©s internes de lâ€™app.

---

## ğŸ§© Type dâ€™app

| Type         | Description                                                                 |
|--------------|------------------------------------------------------------------------------|
| Transversale | Fournit un service technique rÃ©utilisable par plusieurs apps (`glossary`, `market`, etc.) |
| Verticale    | App mÃ©tier qui utilise les services des apps transverses                    |

> Cette app est de type : **`transversale`**  
> Elle est utilisÃ©e par les apps verticales pour gÃ©rer les fichiers multimÃ©dias (images, vidÃ©os, documents).

---

## ğŸ“¦ Imports nÃ©cessaires

```python
from apps.language.utils import get_active_langs
from seo.models import SEOblock
from faiss_pgvector.embeddings import encode_text
```

---

## ğŸ¯ Objectif

Lâ€™app `media` centralise la gestion des fichiers multimÃ©dias utilisÃ©s dans les diffÃ©rentes apps mÃ©tier.  
Elle permet dâ€™uploader, stocker, enrichir, traduire et rÃ©utiliser des contenus visuels (images, vidÃ©os, documents) dans une logique transverse.  
Elle offre des services dâ€™optimisation, de vectorisation, et dâ€™intÃ©gration SEO multilingue.

---

## ğŸ§± ModÃ¨le principal

### `Media`

```python
class Media(models.Model):
    file = models.FileField(upload_to="media/")
    type = models.CharField(max_length=20, choices=MEDIA_TYPES)
    alt_text = models.CharField(max_length=255)
    caption = models.TextField(blank=True)
    copyright = models.CharField(max_length=255, blank=True)
    uploaded_by = models.ForeignKey(User, on_delete=models.SET_NULL, null=True)
    created_at = models.DateTimeField(auto_now_add=True)
    embedding = VectorField(dim=384, null=True, blank=True)
```

> Les champs `alt_text` et `caption` sont traduisibles et synchronisÃ©s avec le modÃ¨le `TranslatableKey` de lâ€™app `language`.

---

## ğŸ§  Logique mÃ©tier

- Traduction automatique des champs `alt_text` et `caption` via `language`
- Synchronisation avec `TranslatableKey` dans `services.py` ou `utils.py`
- GÃ©nÃ©ration de vecteurs sÃ©mantiques Ã  partir des lÃ©gendes (`caption`)
- Stockage des vecteurs dans PostgreSQL (`pgvector`)
- Recherche sÃ©mantique sur les mÃ©dias via FAISS
- Enrichissement SEO des mÃ©dias via `seo`
- GÃ©nÃ©ration de thumbnails et resize automatique
- Gestion des droits dâ€™auteur et licences

---

## ğŸ”Œ IntÃ©grations externes

- **Mistral API** : enrichissement des lÃ©gendes et alt text
- **Cloudflare Images / S3** : stockage distant et CDN
- **OCR API** : extraction de texte depuis les documents (PDF, images)

---

## â± TÃ¢ches Celery

- Recalcul des embeddings pour les lÃ©gendes
- Traduction en batch des mÃ©tadonnÃ©es
- GÃ©nÃ©ration automatique de thumbnails
- Enrichissement SEO des mÃ©dias

---

## ğŸ§ª Tests

- Localisation : `apps/media/tests/`
- Framework : `pytest`
- GÃ©nÃ©ration : `factory_boy`
- Couverture : `pytest-cov`

---

## ğŸ“‚ Structure interne de lâ€™app

```plaintext
media/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ apps.py                         # [0] Configuration Django de lâ€™app
â”œâ”€â”€ models.py                       # [1] ModÃ¨le Media, mÃ©tadonnÃ©es, vecteurs
â”œâ”€â”€ admin.py                        # [6] Interface dâ€™administration, preview, SEO
â”œâ”€â”€ forms.py                        # [7] Formulaires dâ€™upload et de mÃ©tadonnÃ©es
â”œâ”€â”€ serializers.py                  # [2] API pour les mÃ©dias
â”œâ”€â”€ views.py                        # [2] Endpoints dâ€™upload, preview, recherche
â”œâ”€â”€ services.py                     # [3] Resize, vectorisation, enrichissement
â”œâ”€â”€ utils.py                        # [3] Helpers de traduction, SEO, format
â”œâ”€â”€ urls.py                         # [5] Routage local
â”œâ”€â”€ tasks.py                        # [8] TÃ¢ches Celery : enrichissement, traduction
â”œâ”€â”€ signals.py                      # [9] Sync des traductions Ã  la sauvegarde
â”œâ”€â”€ permissions.py                  # [10] Droits dâ€™accÃ¨s aux fichiers
â”œâ”€â”€ management/
â”‚   â””â”€â”€ commands/
â”‚       â””â”€â”€ enrich_media.py         # [11] Commande CLI pour enrichir les mÃ©dias
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ admin/
â”‚       â””â”€â”€ media/
â”‚           â””â”€â”€ preview.html        # [12] Preview admin
â”œâ”€â”€ static/
â”‚   â””â”€â”€ media/
â”‚       â”œâ”€â”€ media_admin.js          # [13] JS spÃ©cifique Ã  lâ€™admin
â”‚       â””â”€â”€ media_admin.css         # [14] CSS spÃ©cifique Ã  lâ€™admin
â”œâ”€â”€ specific/
â”‚   â””â”€â”€ fixtures/
â”‚       â””â”€â”€ media_samples.json      # [15] Fixtures ou scripts non partagÃ©s
â””â”€â”€ tests/                          # [16] Tests unitaires
```

---

## ğŸ§­ RÃ¨gles de structuration

- Les champs traduisibles sont synchronisÃ©s avec `language`
- Le SEO est enrichi via `seo` et validÃ© dans le formulaire admin
- Les embeddings sont gÃ©nÃ©rÃ©s via `faiss_pgvector` et stockÃ©s en base
- Les recherches sÃ©mantiques sont dÃ©lÃ©guÃ©es Ã  FAISS
- Les enrichissements IA sont orchestrÃ©s via tÃ¢ches Celery et commandes
- Lâ€™app respecte lâ€™ordre de dÃ©veloppement dÃ©fini dans [`README Brief Technique.md`](../README Brief Technique.md)
- Les responsabilitÃ©s des fichiers sont strictement dÃ©limitÃ©es
- Toute logique mÃ©tier complexe est placÃ©e dans `services.py`
- Les appels aux apps transverses sont explicites et documentÃ©s
- Aucun fichier inutile ne doit Ãªtre prÃ©sent

---

</code></pre>
</body>
</html>